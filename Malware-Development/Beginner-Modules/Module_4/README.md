
# Table of Contents

1.  [Overview](#org31b9532)
2.  [Structures](#org4c2a335)
    1.  [Example: Basic Structure Definition](#org7d1be26)
    2.  [Common Windows API Structures](#org45083df)
        1.  [STARTUPINFO](#orgd2409f4)
3.  [Using Structures in Malware Development](#org31f48cc)



<a id="org31b9532"></a>

# Overview

This module covers essential C programming concepts that are frequently used in malware development.


<a id="org4c2a335"></a>

# Structures

Structures group related data items of different data types into a single unit, each item within a struct is called a &ldquo;member&rdquo; or &ldquo;element&rdquo;.

Some APIs, like Window&rsquo;s API&rsquo;s require a populated structure as input, while others will take a declared structure and populate it.


<a id="org7d1be26"></a>

## Example: Basic Structure Definition

    #include <stdio.h>
    int main() {
        // Structures are generally declared with the use of typedef keyword to give a structure an alias.
        typedef struct {
            char marca[50];     // string
            int año;           // número entero
            float precio;      // número decimal
            char color[20];    // string
        } Carro;
        // Or define the struct without typedef:
        /*
        struct Carro {
            char marca[50];
            int año;
            float precio;
            char color[20];
        };
        */
        printf("Prueba!\n");
        return 0;
    }


<a id="org45083df"></a>

## Common Windows API Structures


<a id="orgd2409f4"></a>

### STARTUPINFO

Used when creating a new process.

    typedef struct _STARTUPINFOA {
        DWORD  cb;
        LPSTR  lpReserved;
        LPSTR  lpDesktop;
        LPSTR  lpTitle;
        DWORD  dwX;
        DWORD  dwY;
        DWORD  dwXSize;
        DWORD  dwYSize;
        DWORD  dwXCountChars;
        DWORD  dwYCountChars;
        DWORD  dwFillAttribute;
        DWORD  dwFlags;
        WORD   wShowWindow;
        WORD   cbReserved2;
        LPBYTE lpReserved2;
        HANDLE hStdInput;
        HANDLE hStdOutput;
        HANDLE hStdError;
    } STARTUPINFOA, *LPSTARTUPINFOA;


<a id="org31f48cc"></a>

# Using Structures in Malware Development

Structures are essential in malware development as they:

1.  Interface with Windows APIs
2.  Create custom data formats for command and control
3.  Organize and manage malware configuration

